#R script calling the main function and running on the demo data (Data1 from GBM)
library(glmnet)
library(grpreg)
library(survival)
library(MCMCglmm)

source("MainFunction.R")
source("UtilFunctions.R")

options(warn=-1)
#To import the demo dataset
#To import data from each biological level
Gene <- scale(as.matrix(read.csv("Gene.csv", sep=";")))
CNV <- scale(as.matrix(read.csv("CNV.csv", sep=";")))
methy <- scale(as.matrix(read.csv("methy.csv", sep=";")))

#To import information among data from different levls
Gene_Methy <- read.csv("Gene_Methy.csv", sep=";")
Gene_CNV <- read.csv("Gene_CNV.csv",sep=";")
Gene_Pathway <- read.csv("Gene_Pathway.csv", sep=";")

#to import the survival time and other clinical covariables
y <- read.csv("Y.csv",header=TRUE,sep=";")

#to run the main function performing an integrative approach allowing a 
#relation between CNVs and methylations data

#In this example we are interested in the Integrative-gene scenario using a 
#univariate model for the association between methylation sites and CNVs
ana = Integrated_Original(Gene = Gene, methy = methy, CNV = CNV, y = y,
                          Gene_CNV = Gene_CNV, Gene_Methy = Gene_Methy, 
                          Gene_Pathway = Gene_Pathway, multi_methy = FALSE,
                          intra = TRUE, pathway = FALSE,nfolds = 10,
                          alpha = 1, nfoldsIntra = 10)

ana$R2.adj

#In this example we are interested in the Integrative-network scenario using a 
#univariate model for the association between methylation sites and CNVs
ana.network = Integrated_Original(Gene = Gene, methy = methy, CNV = CNV, y = y,
                          Gene_CNV = Gene_CNV, Gene_Methy = Gene_Methy, 
                          Gene_Pathway = Gene_Pathway, multi_methy = FALSE,
                          intra = FALSE, pathway = TRUE,nfolds = 50,
                          alpha = 1, nfoldsIntra = 10)
ana.network$R2.adj

